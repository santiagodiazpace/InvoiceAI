<div class="p-4 md:p-8 min-h-screen bg-background docaiContainer relative">
  <!-- Button open/close sidebar - Solo mostrar si es necesario -->
  <div class="absolute top-4 left-16 md:top-6 md:left-[4.5rem] toggleBtn"
    [ngClass]="{'hidden': (utilService.deviceTypeComputed() === 'desktop' ||
  (utilService.toggleSidebar() && utilService.deviceTypeComputed() !== 'desktop')), 'isMobile': (utilService.deviceTypeComputed() !== 'desktop' && utilService.deviceTypeComputed() !== 'tablet')}">
    <button class=" text-white p-[6px] rounded-sm cursor-pointer" (click)="toggleSidebar()">
      <i class="fa-solid fa-bars"></i>
    </button>
  </div>

  <div class="max-w-7xl mx-auto p-4 md:p-[3rem]" [ngClass]="{
         'noPadding': (utilService.deviceTypeComputed() !== 'desktop' && utilService.deviceTypeComputed() !== 'tablet'),
         'ultra-small-padding': (utilService.deviceTypeComputed() !== 'desktop' && utilService.deviceTypeComputed() !== 'tablet')
       }">
    
    <!-- Header Responsivo -->
    <div class="mb-6 md:mb-8 pt-8 md:pt-0">
      <div class="title text-center md:text-left">
        <h1 class="text-2xl md:text-[2.4rem] font-bold text-white mb-2 bg-gradient-to-r from-main to-hover bg-clip-text text-transparent">DocAI</h1>
        <p class="text-sm md:text-base text-white/70">Procesamiento inteligente de documentos con IA</p>
      </div>
    </div>

    <div class="max-w-2xl md:max-w-4xl mx-auto space-y-4 md:space-y-6">
      <!-- Dropzone Card Responsiva -->
      <div class="bg-gradient-to-br from-background/80 to-background/60 backdrop-blur-sm border border-main/20 rounded-xl overflow-hidden shadow-2xl" data-aos="fade-right">
        <div class="p-4 md:p-6">
          <label class="dropzone block rounded-2xl border-2 border-dashed border-main/30 bg-background/10 p-6 md:p-12 text-center cursor-pointer transition-all duration-300"
                 (dragover)="onDragOver($event)"
                 (dragleave)="onDragLeave($event)"
                 (drop)="onDrop($event)"
                 [ngClass]="{
                   'drag-over': isDragOver(),
                   'hover-state': !isDragOver()
                 }">
            <input type="file" accept="application/pdf" class="hidden" (change)="onPick($event)" #fileInput />
            <div class="space-y-3 md:space-y-4">
              <div class="icon-container w-12 h-12 md:w-16 md:h-16 mx-auto bg-main/20 rounded-full flex items-center justify-center transition-all duration-300 border border-main/30"
                   [ngClass]="{
                     'drag-state': isDragOver()
                   }">
                <i class="fas fa-file-pdf text-main text-xl md:text-2xl transition-colors duration-300"></i>
              </div>
              <div>
                <div class="text-container text-base md:text-xl font-semibold text-white transition-colors duration-300"
                     [ngClass]="{
                       'drag-state': isDragOver()
                     }">
                  {{ isDragOver() ? '¬°Solt√° el archivo aqu√≠!' : 'Arrastr√° un PDF o hac√© click para elegir' }}
                </div>
                <div class="subtitle text-xs md:text-sm text-white/60 mt-2 transition-opacity duration-300"
                     [ngClass]="{
                       'drag-state': isDragOver()
                     }">
                  {{ isDragOver() ? 'üìÑ Archivo PDF detectado - ¬°Soltalo para procesarlo!' : 'Procesamiento local - No se sube a ning√∫n servidor' }}
                </div>
              </div>
            </div>
          </label>
        </div>
      </div>

      <!-- Card de datos y acciones Responsiva -->
      @if(file()){
      <div class="bg-gradient-to-br from-background/80 to-background/60 backdrop-blur-sm border border-main/20 rounded-xl overflow-hidden shadow-2xl" data-aos="fade-left">
        
        <!-- Header de la card -->
        <div class="bg-black/20 px-4 md:px-6 py-3 md:py-4 border-b border-white/10">
          <h3 class="text-white font-semibold text-base md:text-lg flex items-center gap-3">
            <i class="fas fa-file-pdf text-red-400"></i>
            <span class="truncate">Documento Seleccionado</span>
          </h3>
        </div>

        <div class="p-4 md:p-6 space-y-4 md:space-y-6">
          <!-- Indicador de procesamiento -->
          @if(isProcessing()){
          <div class="flex items-center gap-3 p-3 md:p-4 rounded-xl bg-main/20 border border-main/30 backdrop-blur-sm">
            <div class="animate-spin w-5 h-5 md:w-6 md:h-6 border-2 border-main border-t-transparent rounded-full flex-shrink-0"></div>
            <div class="text-main min-w-0">
              <div class="font-semibold text-sm md:text-base">Procesando con IA...</div>
              <div class="text-xs md:text-sm opacity-80">Analizando el documento y extrayendo metadatos</div>
            </div>
          </div>
          }

          <!-- Info del archivo -->
          <div class="bg-main/5 rounded-xl p-3 md:p-4 border border-main/20">
            <div class="flex items-center gap-3 mb-3">
              <div class="w-8 h-8 md:w-10 md:h-10 bg-main/20 rounded-lg flex items-center justify-center border border-main/30 flex-shrink-0">
                <i class="fas fa-file-pdf text-main text-sm md:text-base"></i>
              </div>
              <div class="flex-1 min-w-0">
                <div class="text-white font-medium text-sm md:text-base truncate">{{ file()!.name }}</div>
                <div class="text-white/60 text-xs md:text-sm">{{ (file()!.size/1024/1024) | number:'1.2-2' }} MB</div>
              </div>
            </div>
          </div>

          <!-- Botones de acci√≥n -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4">
            <button type="button" (click)="classifyWithAI()"
                    [disabled]="isProcessing()"
                    class="flex items-center justify-center gap-2 md:gap-3 bg-gradient-to-r from-main to-secondary hover:from-hover hover:to-main text-white px-4 md:px-6 py-3 md:py-4 rounded-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-main/25 hover:scale-105">
              <!-- Spinner -->
              @if(isProcessing()){
              <div class="animate-spin w-4 h-4 md:w-5 md:h-5 border-2 border-white border-t-transparent rounded-full flex-shrink-0"></div>
              }
              @if(!isProcessing()){
              <i class="fas fa-magic text-base md:text-lg"></i>
              }
              <!-- Texto din√°mico -->
              <span class="font-semibold text-sm md:text-base">{{ isProcessing() ? 'Renombrando...' : 'Renombrar CON IA' }}</span>
            </button>
            
            <button type="button" (click)="limpiar()"
                    [disabled]="isProcessing()"
                    class="flex items-center justify-center gap-2 md:gap-3 bg-gradient-to-r from-white/10 to-white/5 hover:from-white/20 hover:to-white/10 border border-white/20 text-white px-4 md:px-6 py-3 md:py-4 rounded-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-white/10 hover:scale-105">
              <i class="fas fa-trash-alt text-sm md:text-base"></i>
              <span class="font-semibold text-sm md:text-base">Limpiar</span>
            </button>
          </div>
        </div>
      </div>
      }

      <!-- Error -->
      @if(error()){
      <div class="bg-gradient-to-r from-red-600/20 to-red-700/20 border border-red-600/40 rounded-xl p-4 backdrop-blur-sm">
        <div class="flex items-center gap-3">
          <div class="w-8 h-8 bg-red-500/20 rounded-lg flex items-center justify-center">
            <i class="fas fa-exclamation-triangle text-red-400"></i>
          </div>
          <div class="text-red-400 font-medium">{{ error() }}</div>
        </div>
      </div>
      }
      
      <!-- JSON de datos extra√≠dos Responsivo -->
      @if(extractedData()){
      <div class="bg-gradient-to-br from-background/80 to-background/60 backdrop-blur-sm border border-main/30 rounded-xl overflow-hidden" data-aos="fade-up">
        <!-- Header -->
        <div class="bg-main/10 px-4 md:px-6 py-3 md:py-4 border-b border-main/20">
          <div class="flex items-center gap-3">
            <div class="w-8 h-8 md:w-10 md:h-10 bg-main/20 rounded-lg flex items-center justify-center flex-shrink-0">
              <i class="fas fa-robot text-main text-base md:text-lg"></i>
            </div>
            <div class="min-w-0">
              <h3 class="text-main font-semibold text-base md:text-lg">Datos extra√≠dos por IA</h3>
              <p class="text-main/70 text-xs md:text-sm">Informaci√≥n procesada del documento</p>
            </div>
          </div>
        </div>

        <div class="p-4 md:p-6 space-y-4 md:space-y-6">
          <!-- Datos formateados para comprobantes -->
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4">
            <div class="bg-main/5 rounded-lg p-3 md:p-4 border border-main/20">
              <div class="text-white/60 text-xs uppercase tracking-wide font-medium mb-1">Tipo de comprobante</div>
              <div class="font-mono text-main font-semibold text-sm">{{ extractedData()?.tipo_comprobante || 'N/A' }}</div>
            </div>
            <div class="bg-main/5 rounded-lg p-3 md:p-4 border border-main/20">
              <div class="text-white/60 text-xs uppercase tracking-wide font-medium mb-1">N√∫mero</div>
              <div class="font-mono text-main font-semibold text-sm">{{ extractedData()?.numero_comprobante || 'N/A' }}</div>
            </div>
            <div class="bg-main/5 rounded-lg p-3 md:p-4 border border-main/20">
              <div class="text-white/60 text-xs uppercase tracking-wide font-medium mb-1">Fecha emisi√≥n</div>
              <div class="font-mono text-main font-semibold text-sm">{{ extractedData()?.fecha_emision || 'N/A' }}</div>
            </div>
            <div class="bg-main/5 rounded-lg p-3 md:p-4 border border-main/20">
              <div class="text-white/60 text-xs uppercase tracking-wide font-medium mb-1">Confianza</div>
              <div class="font-mono text-main font-semibold text-sm">{{ ((extractedData()?.confidence || 0) * 100).toFixed(1) }}%</div>
            </div>
            <div class="bg-main/5 rounded-lg p-3 md:p-4 border border-main/20">
              <div class="text-white/60 text-xs uppercase tracking-wide font-medium mb-1">CUIT Emisor</div>
              <div class="font-mono text-main font-semibold text-sm break-all">{{ extractedData()?.cuit_emisor || 'N/A' }}</div>
            </div>
            <div class="bg-main/5 rounded-lg p-3 md:p-4 border border-main/20">
              <div class="text-white/60 text-xs uppercase tracking-wide font-medium mb-1">CUIT Receptor</div>
              <div class="font-mono text-main font-semibold text-sm break-all">{{ extractedData()?.cuit_receptor || 'N/A' }}</div>
            </div>
            @if(extractedData()?.razon_social_emisor){
            <div class="bg-main/5 rounded-lg p-3 md:p-4 border border-main/20">
              <div class="text-white/60 text-xs uppercase tracking-wide font-medium mb-1">Raz√≥n Social Emisor</div>
              <div class="font-mono text-main font-semibold text-sm break-words">{{ extractedData()?.razon_social_emisor }}</div>
            </div>
            }
            @if(extractedData()?.razon_social_receptor){
            <div class="bg-main/5 rounded-lg p-3 md:p-4 border border-main/20">
              <div class="text-white/60 text-xs uppercase tracking-wide font-medium mb-1">Raz√≥n Social Receptor</div>
              <div class="font-mono text-main font-semibold text-sm break-words">{{ extractedData()?.razon_social_receptor }}</div>
            </div>
            }
            @if(extractedData()?.monto_total){
            <div class="bg-main/5 rounded-lg p-3 md:p-4 border border-main/20">
              <div class="text-white/60 text-xs uppercase tracking-wide font-medium mb-1">Monto Total</div>
              <div class="font-mono text-main font-semibold text-sm">{{ extractedData()?.moneda || '$' }} {{ extractedData()?.monto_total | number:'1.2-2' }}</div>
            </div>
            }
            @if(extractedData()?.letra){
            <div class="bg-main/5 rounded-lg p-3 md:p-4 border border-main/20">
              <div class="text-white/60 text-xs uppercase tracking-wide font-medium mb-1">Letra</div>
              <div class="font-mono text-main font-semibold text-sm">{{ extractedData()?.letra }}</div>
            </div>
            }
            @if(extractedData()?.punto_venta){
            <div class="bg-white/5 rounded-lg p-3 md:p-4 border border-white/10">
              <div class="text-white/60 text-xs uppercase tracking-wide font-medium mb-1">Punto de Venta</div>
              <div class="font-mono text-main font-semibold text-sm">{{ extractedData()?.punto_venta }}</div>
            </div>
            }
            @if(extractedData()?.condicion_iva_emisor){
            <div class="bg-white/5 rounded-lg p-3 md:p-4 border border-white/10">
              <div class="text-white/60 text-xs uppercase tracking-wide font-medium mb-1">Condici√≥n IVA Emisor</div>
              <div class="font-mono text-main font-semibold text-sm break-words">{{ extractedData()?.condicion_iva_emisor }}</div>
            </div>
            }
          </div>
          
          <!-- JSON Raw -->
          <div class="border-t border-white/10 pt-4 md:pt-6">
            <details class="group">
              <summary class="cursor-pointer text-white/80 hover:text-white transition-colors text-sm font-medium flex items-center gap-2 select-none">
                <i class="fas fa-code text-main"></i>
                <span>Ver JSON completo</span>
                <i class="fas fa-chevron-down text-xs text-white/60 group-open:rotate-180 transition-transform ml-auto"></i>
              </summary>
              <div class="mt-4 bg-black/30 rounded-lg border border-white/10 overflow-hidden">
                <div class="bg-black/20 px-3 py-2 text-xs text-white/60 border-b border-white/10 font-mono">
                  application/json
                </div>
                <pre class="p-3 md:p-4 text-xs text-main overflow-auto max-h-64 md:max-h-96">{{ extractedData() ? (extractedData() | json) : 'No hay datos' }}</pre>
              </div>
            </details>
          </div>
        </div>
      </div>
      }
    </div>
  </div>
</div>
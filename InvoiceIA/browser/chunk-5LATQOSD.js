import{$ as h,Aa as ne,Ba as _,Ca as v,Da as B,Ea as G,Fa as U,Ga as O,H as Q,Ha as r,I as ee,Ia as a,Ja as f,K as le,Ka as P,La as D,M as te,Ma as p,Na as M,Oa as l,Pa as g,Qa as I,R as V,Ra as de,S,Sa as ue,T as C,Ta as k,U as F,Ua as oe,Va as re,Za as T,fb as me,gb as pe,hb as he,ib as fe,ja as c,jb as ge,qa as ce,ra as ie}from"./chunk-UDRQ3NXB.js";import{a as E,b as $}from"./chunk-E6TGZIGP.js";var Fe={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},ri=$(E({},Fe),{"[class.ng-submitted]":"isSubmitted"});var Ne=new le("",{providedIn:"root",factory:()=>ve}),ve="always";var Pe=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=ie({type:i});static \u0275inj=ee({})}return i})();var be=(()=>{class i{static withConfig(t){return{ngModule:i,providers:[{provide:Ne,useValue:t.callSetDisabledState??ve}]}}static \u0275fac=function(n){return new(n||i)};static \u0275mod=ie({type:i});static \u0275inj=ee({imports:[Pe]})}return i})();var H=class i{deviceTypeSingal=h("");deviceTypeComputed=T(()=>this.deviceTypeSingal());toggleSidebar=h(!0);constructor(){this.getDeviceType(),window.addEventListener("resize",this.getDeviceType.bind(this))}setToggleSidebar(e){this.toggleSidebar.set(e)}toggleSidebarState(){this.toggleSidebar.set(!this.toggleSidebar())}getDeviceType(){let e=window.innerWidth;e<=768?e<=320?this.deviceTypeSingal.set("mobile-s"):e<=375?this.deviceTypeSingal.set("mobile-m"):e<=425?this.deviceTypeSingal.set("mobile-l"):e<=768&&this.deviceTypeSingal.set("mobile-xl"):e<1024?this.deviceTypeSingal.set("tablet"):this.deviceTypeSingal.set("desktop")}static \u0275fac=function(t){return new(t||i)};static \u0275prov=Q({token:i,factory:i.\u0275fac,providedIn:"root"})};var j={production:!1,apiBase:"https://gemini-proxy-ewww.onrender.com"};var w=class{constructor(e=0,t="Network Error"){this.status=e,this.text=t}};var ye=()=>{if(!(typeof localStorage>"u"))return{get:i=>Promise.resolve(localStorage.getItem(i)),set:(i,e)=>Promise.resolve(localStorage.setItem(i,e)),remove:i=>Promise.resolve(localStorage.removeItem(i))}};var y={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:ye()};var R=i=>i?typeof i=="string"?{publicKey:i}:i.toString()==="[object Object]"?i:{}:{};var Ce=(i,e="https://api.emailjs.com")=>{if(!i)return;let t=R(i);y.publicKey=t.publicKey,y.blockHeadless=t.blockHeadless,y.storageProvider=t.storageProvider,y.blockList=t.blockList,y.limitRate=t.limitRate,y.origin=t.origin||e};var X=async(i,e,t={})=>{let n=await fetch(y.origin+i,{method:"POST",headers:t,body:e}),o=await n.text(),s=new w(n.status,o);if(n.ok)return s;throw s};var z=(i,e,t)=>{if(!i||typeof i!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!e||typeof e!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!t||typeof t!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"};var xe=i=>{if(i&&i.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"};var W=i=>i.webdriver||!i.languages||i.languages.length===0;var q=()=>new w(451,"Unavailable For Headless Browser");var Ae=(i,e)=>{if(!Array.isArray(i))throw"The BlockList list has to be an array";if(typeof e!="string")throw"The BlockList watchVariable has to be a string"};var Oe=i=>!i.list?.length||!i.watchVariable,Te=(i,e)=>i instanceof FormData?i.get(e):i[e],J=(i,e)=>{if(Oe(i))return!1;Ae(i.list,i.watchVariable);let t=Te(e,i.watchVariable);return typeof t!="string"?!1:i.list.includes(t)};var Y=()=>new w(403,"Forbidden");var De=(i,e)=>{if(typeof i!="number"||i<0)throw"The LimitRate throttle has to be a positive number";if(e&&typeof e!="string")throw"The LimitRate ID has to be a non-empty string"};var Re=async(i,e,t)=>{let n=Number(await t.get(i)||0);return e-Date.now()+n},K=async(i,e,t)=>{if(!e.throttle||!t)return!1;De(e.throttle,e.id);let n=e.id||i;return await Re(n,e.throttle,t)>0?!0:(await t.set(n,Date.now().toString()),!1)};var Z=()=>new w(429,"Too Many Requests");var Ee=async(i,e,t,n)=>{let o=R(n),s=o.publicKey||y.publicKey,u=o.blockHeadless||y.blockHeadless,b=o.storageProvider||y.storageProvider,d=E(E({},y.blockList),o.blockList),x=E(E({},y.limitRate),o.limitRate);return u&&W(navigator)?Promise.reject(q()):(z(s,i,e),xe(t),t&&J(d,t)?Promise.reject(Y()):await K(location.pathname,x,b)?Promise.reject(Z()):X("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:s,service_id:i,template_id:e,template_params:t}),{"Content-type":"application/json"}))};var Ve=i=>{if(!i||i.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"};var ke=i=>typeof i=="string"?document.querySelector(i):i,Se=async(i,e,t,n)=>{let o=R(n),s=o.publicKey||y.publicKey,u=o.blockHeadless||y.blockHeadless,b=y.storageProvider||o.storageProvider,d=E(E({},y.blockList),o.blockList),x=E(E({},y.limitRate),o.limitRate);if(u&&W(navigator))return Promise.reject(q());let A=ke(t);z(s,i,e),Ve(A);let m=new FormData(A);return J(d,m)?Promise.reject(Y()):await K(location.pathname,x,b)?Promise.reject(Z()):(m.append("lib_version","4.4.1"),m.append("service_id",i),m.append("template_id",e),m.append("user_id",s),X("/api/v1.0/email/send-form",m))};var ae={init:Ce,send:Ee,sendForm:Se,EmailJSResponseStatus:w};var je=(i,e,t,n)=>({"drag-over":i,"drag-idle":e,"single-file":t,"multiple-files":n});function Le(i,e){i&1&&(r(0,"p",19),l(1," Solt\xE1 para procesar 1 archivo "),a(),r(2,"p",20),l(3," Formato "),a())}function $e(i,e){if(i&1&&(r(0,"p",21),l(1),a(),r(2,"p",22),l(3," ZIP organizado "),a()),i&2){let t=p();c(),I(" Solt\xE1 para procesar ",t.getDragFileCount()," archivos ")}}function Be(i,e){i&1&&(r(0,"p",9),l(1," Arrastr\xE1 un PDF o hac\xE9 click para elegir "),a())}function Ge(i,e){i&1&&(C(),r(0,"svg",27),f(1,"circle",32)(2,"path",33),a())}function Ue(i,e){i&1&&(C(),r(0,"svg",28),f(1,"path",34),a())}function He(i,e){i&1&&l(0," \u26A1 Analizando con IA... ")}function Xe(i,e){i&1&&l(0," \u2728 Listo para analizar con IA ")}function ze(i,e){if(i&1&&(r(0,"div",11)(1,"div",23)(2,"h3",24),l(3,"\u{1F4C4} Archivo Seleccionado"),a(),r(4,"span",25),l(5," 1 archivo "),a()(),r(6,"div",26),_(7,Ge,3,0,":svg:svg",27)(8,Ue,2,0,":svg:svg",28),r(9,"span",29),l(10),a(),r(11,"span",30),l(12),k(13,"number"),a()(),r(14,"div",31),_(15,He,1,0)(16,Xe,1,0),a()()),i&2){let t,n,o=p();c(6),M("text-blue-300",!o.isProcessing())("text-blue-400",o.isProcessing()),c(),v(o.isProcessing()?7:8),c(3),g((t=o.file())==null?null:t.name),c(2),I("",re(13,8,(((n=o.file())==null?null:n.size)||0)/1024/1024,"1.1-1")," MB"),c(3),v(o.isProcessing()?15:16)}}function We(i,e){i&1&&(C(),r(0,"svg",40),f(1,"path",43),a())}function qe(i,e){i&1&&(C(),r(0,"svg",41),f(1,"circle",32)(2,"path",33),a())}function Je(i,e){i&1&&(C(),r(0,"svg",42),f(1,"path",44),a())}function Ye(i,e){if(i&1&&(r(0,"div",26),_(1,We,2,0,":svg:svg",40)(2,qe,3,0,":svg:svg",41)(3,Je,2,0,":svg:svg",42),r(4,"span",29),l(5),a()()),i&2){let t=e.$implicit,n=e.$index,o=p(2);M("text-purple-300",n===o.archivoActual())("text-slate-400",n!==o.archivoActual()),c(),v(n<o.archivoActual()?1:n===o.archivoActual()?2:3),c(4),g(t.name)}}function Ke(i,e){if(i&1&&(r(0,"div",12)(1,"div",23)(2,"h3",35),l(3,"\u{1F4E6} Modo M\xFAltiples Archivos"),a(),r(4,"span",36),l(5),a()(),r(6,"div",37),G(7,Ye,6,6,"div",38,B),a(),r(9,"div",39),l(10," \u2728 Modo organizaci\xF3n autom\xE1tica activado - Todos los archivos se agregar\xE1n al ZIP "),a()()),i&2){let t=p();c(5),I(" ",t.colaArchivos().length," archivos "),c(2),U(t.colaArchivos())}}function Ze(i,e){if(i&1&&(r(0,"div",13)(1,"p",45),l(2),a()()),i&2){let t=p();c(2),g(t.error())}}function Qe(i,e){if(i&1&&(r(0,"div",47),C(),r(1,"svg",48),f(2,"circle",32)(3,"path",33),a(),l(4),a()),i&2){let t=p(2);c(4),de(" Procesando ",t.archivoActual()+1,"/",t.colaArchivos().length,"... ")}}function et(i,e){if(i&1&&l(0),i&2){let t=p(2);I(" \u{1F680} Procesar ",t.colaArchivos().length," Archivos con IA ")}}function tt(i,e){if(i&1){let t=P();r(0,"button",46),D("click",function(){V(t);let o=p();return S(o.procesarTodosLosArchivos())}),_(1,Qe,5,2,"div",47)(2,et,1,1),a()}if(i&2){let t=p();O("disabled",t.isProcessing()),c(),v(t.isProcessing()?1:2)}}function it(i,e){i&1&&l(0," Obteniendo datos... ")}function nt(i,e){i&1&&l(0," Validando... ")}function ot(i,e){i&1&&l(0," Procesando... ")}function rt(i,e){if(i&1&&(r(0,"div",47),C(),r(1,"svg",48),f(2,"circle",32)(3,"path",33),a(),_(4,it,1,0)(5,nt,1,0)(6,ot,1,0),a()),i&2){let t,n=p(2);c(4),v((t=n.processingState())==="obteniendo"?4:t==="validando"?5:6)}}function at(i,e){i&1&&l(0," \u{1F916} Procesar IA ")}function st(i,e){if(i&1){let t=P();r(0,"button",49),D("click",function(){V(t);let o=p();return S(o.classifyWithAIV2())}),_(1,rt,7,1,"div",47)(2,at,1,0),a()}if(i&2){let t=p();O("disabled",!t.file()||t.isProcessing()),c(),v(t.isProcessing()?1:2)}}function lt(i,e){i&1&&(r(0,"span",65),l(1,"PAGAR"),a())}function ct(i,e){i&1&&(r(0,"span",66),l(1,"E-MAIL"),a())}function dt(i,e){if(i&1){let t=P();r(0,"div",16)(1,"div",50),D("click",function(){V(t);let o=p();return S(o.toggleMetadatos("extractedData"))}),r(2,"div",51)(3,"h3",52),f(4,"i",53),l(5," \u{1F4C4} Metadatos Extra\xEDdos "),a(),r(6,"div",54)(7,"span",55),l(8),a(),f(9,"i",56),a()()(),r(10,"div",57)(11,"div",58)(12,"div",59)(13,"div",60)(14,"div",61)(15,"span",62),l(16,"Tipo:"),a(),r(17,"span",63),l(18),a()(),r(19,"div",61)(20,"span",62),l(21,"Subtipo:"),a(),r(22,"span",63),l(23),a()(),r(24,"div",61)(25,"span",62),l(26,"Fecha:"),a(),r(27,"span",63),l(28),a()(),r(29,"div",61)(30,"span",62),l(31,"N\xFAmero:"),a(),r(32,"span",63),l(33),a()()(),r(34,"div",60)(35,"div",61)(36,"span",62),l(37,"CUIT Emisor:"),a(),r(38,"span",63),l(39),a()(),r(40,"div",61)(41,"span",62),l(42,"CUIT Receptor:"),a(),r(43,"span",63),l(44),a()(),r(45,"div",61)(46,"span",62),l(47,"Monto:"),a(),r(48,"span",63),l(49),a()(),r(50,"div",64)(51,"span",62),l(52,"Estado:"),a(),r(53,"div",54),_(54,lt,2,0,"span",65)(55,ct,2,0,"span",66),a()()()(),r(56,"div",67)(57,"h4",68),f(58,"i",69),l(59," JSON Completo: "),a(),r(60,"pre",70),l(61),k(62,"json"),a()()()()()}if(i&2){let t,n,o,s,u,b,d,x,A,m=p();c(8),I(" ",((t=m.extractedData())==null?null:t.tipo_comprobante)||"N/A"," "),c(),M("rotate-180",m.mostrarMetadatos().extractedData),c(),M("expanded",m.mostrarMetadatos().extractedData)("collapsed",!m.mostrarMetadatos().extractedData),c(8),g((n=m.extractedData())==null?null:n.tipo_comprobante),c(5),g(((o=m.extractedData())==null?null:o.subtipo_comprobante)||"N/A"),c(5),g(((s=m.extractedData())==null?null:s.fecha_emision)||"N/A"),c(5),g(((u=m.extractedData())==null?null:u.numero_comprobante)||"N/A"),c(6),g(((b=m.extractedData())==null?null:b.cuit_emisor)||"N/A"),c(5),g(((d=m.extractedData())==null?null:d.cuit_receptor)||"N/A"),c(5),g((x=m.extractedData())!=null&&x.monto_total?"$"+((x=m.extractedData())==null?null:x.monto_total):"N/A"),c(5),v((A=m.verificarEstadoFactura((A=m.extractedData())==null?null:A.monto_total))==="PAGAR"?54:A==="EMAIL"?55:-1),c(7),g(oe(62,16,m.extractedData()))}}function ut(i,e){i&1&&(r(0,"span",65),l(1,"PAGAR"),a())}function mt(i,e){i&1&&(r(0,"span",66),l(1,"E-MAIL"),a())}function pt(i,e){i&1&&(r(0,"span",84),l(1,"\u2713 OK"),a())}function ht(i,e){i&1&&(r(0,"span",85),l(1,"\u2717 ERROR"),a())}function ft(i,e){if(i&1&&(r(0,"div",98)(1,"h4",99),f(2,"i",100),l(3," \u{1F50D} Validaci\xF3n AFIP "),a(),r(4,"pre",101),l(5),a()()),i&2){let t=p().$implicit;c(5),g(t.validacionAFIP)}}function gt(i,e){if(i&1){let t=P();r(0,"div",75)(1,"div",78),D("click",function(){let o=V(t).$index,s=p(2);return S(s.toggleMetadatos("archivo_"+o))}),r(2,"div",51)(3,"div",79),f(4,"i",80),r(5,"div",81)(6,"p",82),l(7),a(),r(8,"p",83),l(9),a()()(),r(10,"div",54)(11,"div",54),_(12,ut,2,0,"span",65)(13,mt,2,0,"span",66),_(14,pt,2,0,"span",84)(15,ht,2,0,"span",85),a(),r(16,"button",86),D("click",function(o){let s=V(t).$index;return p(2).abrirChat(s),S(o.stopPropagation())}),C(),r(17,"svg",87),f(18,"path",88),a()(),F(),r(19,"button",89),D("click",function(o){let s=V(t).$index;return p(2).eliminarArchivoProcesado(s),S(o.stopPropagation())}),C(),r(20,"svg",90),f(21,"path",91),a()(),F(),f(22,"i",56),a()()(),r(23,"div",57)(24,"div",92)(25,"div",93)(26,"div",60)(27,"div",61)(28,"span",62),l(29,"Tipo:"),a(),r(30,"span",63),l(31),a()(),r(32,"div",61)(33,"span",62),l(34,"Subtipo:"),a(),r(35,"span",63),l(36),a()(),r(37,"div",61)(38,"span",62),l(39,"Fecha:"),a(),r(40,"span",63),l(41),a()(),r(42,"div",61)(43,"span",62),l(44,"N\xFAmero:"),a(),r(45,"span",63),l(46),a()()(),r(47,"div",60)(48,"div",61)(49,"span",62),l(50,"CUIT Emisor:"),a(),r(51,"span",63),l(52),a()(),r(53,"div",61)(54,"span",62),l(55,"CUIT Receptor:"),a(),r(56,"span",63),l(57),a()(),r(58,"div",61)(59,"span",62),l(60,"Monto:"),a(),r(61,"span",63),l(62),a()(),r(63,"div",61)(64,"span",62),l(65,"Archivo:"),a(),r(66,"span",94),l(67),a()()()(),r(68,"div",95)(69,"div",96)(70,"h4",68),f(71,"i",69),l(72," JSON Completo: "),a(),r(73,"pre",97),l(74),k(75,"json"),a()(),_(76,ft,6,1,"div",98),a()()()()}if(i&2){let t,n,o=e.$implicit,s=e.$index,u=p(2);ne("data-aos-delay",s*100),c(7),g(o.file.name),c(2),g(o.data.tipo_comprobante||"N/A"),c(3),v((t=u.verificarEstadoFactura(o==null||o.data==null?null:o.data.monto_total))==="PAGAR"?12:t==="EMAIL"?13:-1),c(2),v((n=u.verificarValidacionAFIP(o==null?null:o.validacionAFIP))==="OK"?14:n==="ERROR"?15:-1),c(8),M("rotate-180",u.mostrarMetadatos()["archivo_"+s]),c(),M("expanded",u.mostrarMetadatos()["archivo_"+s])("collapsed",!u.mostrarMetadatos()["archivo_"+s]),c(8),g(o.data.tipo_comprobante),c(5),g(o.data.subtipo_comprobante||"N/A"),c(5),g(o.data.fecha_emision||"N/A"),c(5),g(o.data.numero_comprobante||"N/A"),c(6),g(o.data.cuit_emisor||"N/A"),c(5),g(o.data.cuit_receptor||"N/A"),c(5),g(o.data.monto_total?"$"+o.data.monto_total:"N/A"),c(5),g(o.fileName),c(7),g(oe(75,21,o.data)),c(2),v(o.validacionAFIP?76:-1)}}function _t(i,e){if(i&1){let t=P();r(0,"div",17)(1,"div",23)(2,"h3",71),f(3,"i",72),l(4," \u{1F4C4} Archivos Procesados "),a(),r(5,"span",73),l(6),a()(),r(7,"div",74),G(8,gt,77,23,"div",75,B),a(),r(10,"div",76)(11,"button",77),D("click",function(){V(t);let o=p();return S(o.limpiarArchivosProcessados())}),l(12," Limpiar Lista "),a()()()}if(i&2){let t=p();c(6),I(" ",t.archivosProcesados().length," archivo(s) "),c(2),U(t.archivosProcesados())}}function vt(i,e){if(i&1&&(r(0,"p",109),l(1),a()),i&2){let t=p(2);c(),I(" ",t.archivosProcesados()[t.facturaSeleccionadaParaChat()].fileName," ")}}function bt(i,e){i&1&&(r(0,"div",113)(1,"div",122),C(),r(2,"svg",123),f(3,"path",88),a()(),F(),r(4,"h4",124),l(5,"\xA1Hola! Soy tu asistente de facturas"),a(),r(6,"p",125),l(7,"Preg\xFAntame lo que necesites sobre esta factura"),a(),r(8,"div",126)(9,"div",127)(10,"p",128),l(11,'\u{1F4A1} "\xBFCu\xE1l es el monto total de esta factura?"'),a()(),r(12,"div",127)(13,"p",128),l(14,'\u{1F4A1} "\xBFCumple con las normativas de AFIP?"'),a()(),r(15,"div",127)(16,"p",128),l(17,'\u{1F4A1} "\xBFQu\xE9 errores detectaste en la validaci\xF3n?"'),a()()()())}function yt(i,e){i&1&&(r(0,"div",130),C(),r(1,"svg",136),f(2,"path",137),a()())}function Ct(i,e){i&1&&(r(0,"div",131),C(),r(1,"svg",136),f(2,"path",138),a()())}function xt(i,e){if(i&1&&(r(0,"div",115)(1,"div",129),_(2,yt,3,0,"div",130)(3,Ct,3,0,"div",131),a(),r(4,"div",132)(5,"div",133)(6,"p",134),l(7),a()(),r(8,"p",135),l(9),k(10,"date"),a()()()),i&2){let t=e.$implicit;M("flex-row-reverse",t.role==="user"),c(2),v(t.role==="user"?2:3),c(3),M("bg-blue-600",t.role==="user")("bg-slate-800/60",t.role==="assistant")("border",t.role==="assistant")("border-slate-700/50",t.role==="assistant"),c(),M("text-white",t.role==="user")("text-slate-200",t.role==="assistant"),c(),g(t.content),c(),M("text-right",t.role==="user"),c(),I(" ",re(10,19,t.timestamp,"shortTime")," ")}}function At(i,e){i&1&&(r(0,"div",115)(1,"div",131),C(),r(2,"svg",139),f(3,"path",138),a()(),F(),r(4,"div",140)(5,"div",141),f(6,"div",142)(7,"div",143)(8,"div",144),a()()())}function Dt(i,e){i&1&&(C(),r(0,"svg",120),f(1,"circle",32)(2,"path",33),a())}function Et(i,e){i&1&&(C(),r(0,"svg",87),f(1,"path",145),a())}function Vt(i,e){if(i&1){let t=P();r(0,"div",102),D("click",function(){V(t);let o=p();return S(o.cerrarChat())}),r(1,"div",103),D("click",function(o){return V(t),S(o.stopPropagation())}),r(2,"div",104)(3,"div",105)(4,"div",106),C(),r(5,"svg",107),f(6,"path",88),a()(),F(),r(7,"div")(8,"h3",108),l(9,"\u{1F4AC} Chat con IA"),a(),_(10,vt,2,1,"p",109),a()(),r(11,"button",110),D("click",function(){V(t);let o=p();return S(o.cerrarChat())}),C(),r(12,"svg",111),f(13,"path",91),a()()(),F(),r(14,"div",112),_(15,bt,18,0,"div",113),G(16,xt,11,22,"div",114,B),_(18,At,9,0,"div",115),a(),r(19,"div",116)(20,"div",117)(21,"input",118),D("input",function(o){V(t);let s=p();return S(s.chatInput.set(o.target.value))})("keydown.enter",function(){V(t);let o=p();return S(o.enviarMensajeChat())}),a(),r(22,"button",119),D("click",function(){V(t);let o=p();return S(o.enviarMensajeChat())}),_(23,Dt,3,0,":svg:svg",120)(24,Et,2,0,":svg:svg",87),l(25," Enviar "),a()(),r(26,"p",121),l(27," Presiona Enter para enviar \u2022 La IA tiene contexto de la factura y su validaci\xF3n "),a()()()()}if(i&2){let t=p();c(10),v(t.facturaSeleccionadaParaChat()!==null?10:-1),c(5),v(t.chatHistory().length===0?15:-1),c(),U(t.chatHistory()),c(2),v(t.chatProcesando()?18:-1),c(3),O("value",t.chatInput())("disabled",t.chatProcesando()),c(),O("disabled",!t.chatInput().trim()||t.chatProcesando()),c(),v(t.chatProcesando()?23:24)}}var Me={"Factura A":"FacA","Factura B":"FacB","Factura C":"FacC","Factura E":"FacE","Factura de Exportaci\xF3n":"FacE","Factura de Exportaci\xF3n E":"FacE","Factura de Cr\xE9dito Electr\xF3nica MiPyMEs (FCE) A":"FceA","Factura de Cr\xE9dito Electr\xF3nica MiPyMEs (FCE) B":"FceB","Nota de Cr\xE9dito A":"NdcA","Nota de Cr\xE9dito B":"NdcB","Nota de D\xE9bito A":"NddA","Nota de D\xE9bito B":"NddB",Informe:"Inf","Orden de Pago":"OrdP",Retenci\u00F3n:"Ret"},se={TLA:"TLA",CFA:"CFA",FavaHnos:"FavaH",Favanet:"FavaN",Favacard:"FavaC","FAVA HNOS":"FavaH","FAVA CARD":"FavaC","FAVA NET":"FavaN","TALLER LA ARGENTINA":"TLA",TALLER:"TLA","LA ARGENTINA":"TLA",TAMA:"TLA","TARJETAS DEL MAR":"TLA","TARJETAS DEL MAR S.A.":"TLA","FAVACARD SA":"FavaC","FAVACARD S.A.":"FavaC","FAVANET SA":"FavaN","FAVANET S.A.":"FavaN","FAVA HERMANOS":"FavaH",FAVAHNOS:"FavaH"},we=class i{utilService=te(H);file=h(null);error=h(null);isProcessing=h(!1);processingState=h("idle");extractedData=h(null);isDragOver=h(!1);dragFileCount=h(0);mostrarPagar=h(!1);mostrarEmail=h(!1);chatAbierto=h(!1);facturaSeleccionadaParaChat=h(null);chatHistory=h([]);chatInput=h("");chatProcesando=h(!1);verificarEstadoFactura(e){return e?e<5e4?"PAGAR":"EMAIL":null}verificarValidacionAFIP(e){return e?e.includes("\u274C ERRORES CR\xCDTICOS:")&&!e.includes(`\u274C ERRORES CR\xCDTICOS:
- Ninguno detectado`)?"ERROR":"OK":null}abrirChat(e){this.facturaSeleccionadaParaChat.set(e),this.chatAbierto.set(!0),this.chatHistory.set([]),this.chatInput.set("")}cerrarChat(){this.chatAbierto.set(!1),this.facturaSeleccionadaParaChat.set(null),this.chatHistory.set([]),this.chatInput.set("")}async enviarMensajeChat(){let e=this.chatInput().trim();if(!e||this.chatProcesando())return;let t=this.facturaSeleccionadaParaChat();if(t===null)return;let n=this.archivosProcesados()[t];if(n){this.chatHistory.update(o=>[...o,{role:"user",content:e,timestamp:new Date}]),this.chatInput.set(""),this.chatProcesando.set(!0);try{let o=`
DATOS DE LA FACTURA:
${JSON.stringify(n.data,null,2)}

VALIDACI\xD3N AFIP:
${n.validacionAFIP||"No disponible"}

NOMBRE DEL ARCHIVO:
${n.fileName}

RUTA:
${n.fullPath}
`,s=this.chatHistory().slice(-6).map(m=>`${m.role==="user"?"Usuario":"Asistente"}: ${m.content}`).join(`

`),b={contents:[{parts:[{text:`Eres un asistente experto en facturas y normativas de AFIP (Argentina).

${o}

HISTORIAL DE CONVERSACI\xD3N:
${s}

NUEVA PREGUNTA DEL USUARIO:
${e}

Responde de manera clara, concisa y profesional. Si la pregunta es sobre datos espec\xEDficos de la factura, usa los datos proporcionados. Si es sobre normativas, explica de forma comprensible.`}]}],generationConfig:{maxOutputTokens:1e3,temperature:.7}},d=await fetch(`${j.apiBase}/ai/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"gemini-2.5-flash-lite",payload:b})});if(!d.ok)throw new Error(`HTTP ${d.status}`);let A=(await d.json())?.candidates?.[0]?.content?.parts?.[0]?.text||"No pude generar una respuesta.";this.chatHistory.update(m=>[...m,{role:"assistant",content:A,timestamp:new Date}])}catch(o){console.error("Error en chat:",o),this.chatHistory.update(s=>[...s,{role:"assistant",content:"\u274C Error al procesar tu pregunta. Por favor, intenta de nuevo.",timestamp:new Date}])}finally{this.chatProcesando.set(!1)}}}colaArchivos=h([]);archivoActual=h(0);procesandoMultiples=h(!1);selectedEjercicio=h("EJ01");ejercicios=["EJ01","EJ02","EJ03","EJ04","EJ05"];form={type:"desconocido",subtipo:"",dateISO:"",puesto:"",numeroSecuencial:"",empresaCodigo:"",ejercicio:"EJ01"};organizarEnCarpetas=h(!1);archivosProcesados=h([]);generarMetadata=h(!1);metadataPorDirectorio=h(new Map);finalNameV2=T(()=>{let e=this.validISO(this.form.dateISO)?this.form.dateISO:this.todayISO(),[t,n]=e.split("-"),o=this.getComprobanteCodigo(this.form.subtipo||this.form.type),s=this.getUltimos4Digitos(this.form.numeroSecuencial),u=this.form.empresaCodigo||"XXX";return`${t}-${n}-${o}-${s}-${u}.pdf`});fullPathV2=T(()=>{let e=this.validISO(this.form.dateISO)?this.form.dateISO:this.todayISO(),[t,n]=e.split("-"),o=this.form.ejercicio,s=this.finalNameV2();return`/${o}/Ventas/${t}-${n}/${s}`});onPick(e){this.error.set(null),this.extractedData.set(null);let n=e.target.files;if(n&&n.length>0)if(n.length===1)this.handleFile(n[0]);else{let o=Array.from(n).filter(s=>s.type==="application/pdf");if(o.length===0){this.error.set("Todos los archivos deben ser PDF.");return}this.manejarMultiplesArchivos(o)}}onDragOver(e){e.preventDefault(),e.stopPropagation(),this.isDragOver.set(!0);let t=e.dataTransfer?.items;if(t){let n=0;for(let o=0;o<t.length;o++)t[o].type==="application/pdf"&&n++;this.dragFileCount.set(n),console.log(`\u{1F3AF} Drag detectado: ${n} archivos PDF`)}}onDragLeave(e){e.preventDefault(),e.stopPropagation(),this.isDragOver.set(!1),this.dragFileCount.set(0)}onDrop(e){e.preventDefault(),e.stopPropagation(),this.isDragOver.set(!1),this.dragFileCount.set(0);let t=e.dataTransfer?.files;if(t&&t.length>0){let n=Array.from(t).filter(o=>o.type==="application/pdf");if(n.length===0){this.error.set("Todos los archivos deben ser PDF.");return}n.length===1?this.handleFile(n[0]):this.manejarMultiplesArchivos(n)}}handleFile(e){if(e){if(e.type!=="application/pdf"){this.error.set("El archivo debe ser PDF.");return}this.file.set(e)}}getDragFileCount(){return this.dragFileCount()}mostrarMetadatos=h({});toggleMetadatos(e){let t=this.mostrarMetadatos();this.mostrarMetadatos.set($(E({},t),{[e]:!t[e]}))}limpiar(){this.form={type:"desconocido",subtipo:"",dateISO:"",puesto:"",numeroSecuencial:"",empresaCodigo:"",ejercicio:this.selectedEjercicio()},this.extractedData.set(null),this.error.set(null),this.archivosProcesados.set([]),this.colaArchivos.set([]),this.archivoActual.set(0),this.procesandoMultiples.set(!1),this.mostrarPagar.set(!1)}manejarMultiplesArchivos(e){this.organizarEnCarpetas.set(!0),this.colaArchivos.set(e),this.archivoActual.set(0),this.procesandoMultiples.set(!0),this.file.set(e[0]),this.error.set(null),console.log(`\u{1F4C1} ${e.length} archivos agregados a la cola para procesamiento`)}async procesarTodosLosArchivos(){let e=this.colaArchivos();if(e.length===0){this.error.set("No hay archivos en la cola");return}this.isProcessing.set(!0),this.processingState.set("obteniendo"),this.error.set(null);try{for(let t=0;t<e.length;t++)this.archivoActual.set(t),this.file.set(e[t]),console.log(`\u{1F4C4} Procesando archivo ${t+1}/${e.length}: ${e[t].name}`),await this.classifyWithAISingle(e[t]),await new Promise(n=>setTimeout(n,500));console.log("\u2705 Todos los archivos procesados exitosamente"),this.colaArchivos.set([]),this.procesandoMultiples.set(!1),this.archivoActual.set(0)}catch(t){this.error.set("Error procesando m\xFAltiples archivos: "+t.message)}finally{this.isProcessing.set(!1),this.processingState.set("idle")}}async classifyWithAISingle(e){let t=await this.fileToBase64(e),o={contents:[{parts:[{inline_data:{mime_type:e.type||"application/pdf",data:t}},{text:`Analiza este documento PDF para el sistema ODA Invoice.

IMPORTANTE: Debes ser MUY ESPEC\xCDFICO con el tipo exacto de comprobante.

EXTRAE INFORMACI\xD3N ESPEC\xCDFICA PARA FORMATO: AAAA-MM-CCCC-NNNN-EEEE.pdf

DETECCI\xD3N PRIORITARIA - BUSCA EXACTAMENTE:
1. FACTURAS: Busca en el documento el tipo espec\xEDfico
   - Si ves "FACTURA A" o "COD A" \u2192 subtipo_comprobante: "Factura A"
   - Si ves "FACTURA B" o "COD B" \u2192 subtipo_comprobante: "Factura B"  
   - Si ves "FACTURA C" o "COD C" \u2192 subtipo_comprobante: "Factura C"
   - Si ves "FACTURA E" o "COD E" o "EXPORTACI\xD3N" \u2192 subtipo_comprobante: "Factura E"
   - Si es FCE \u2192 subtipo_comprobante: "Factura de Cr\xE9dito Electr\xF3nica MiPyMEs (FCE) A"

2. NOTAS: "Nota de Cr\xE9dito A", "Nota de D\xE9bito A", etc.

3. INFORMES: Reportes, consultor\xEDas, supervisiones \u2192 subtipo_comprobante: "Informe"

4. \xD3RDENES DE PAGO: Autorizaciones \u2192 subtipo_comprobante: "Orden de Pago"

5. RETENCIONES: Certificados \u2192 subtipo_comprobante: "Retenci\xF3n"

EXTRACCI\xD3N DE N\xDAMEROS - MUY IMPORTANTE:
- Busca "Comp. Nro:" o "N\xFAmero:" seguido del formato "XXXX-XXXXXXXX"
- Ejemplo: "Comp. Nro: 00003-00000001"
  - puesto: "00003" (parte antes del gui\xF3n)
  - numero_secuencial: "00000001" (parte despu\xE9s del gui\xF3n)

CAMPOS REQUERIDOS:
- tipo_comprobante: (factura|informe|orden_de_pago|retenciones|desconocido)
- subtipo_comprobante: EL TIPO EXACTO con letra (ej: "Factura A", "Factura E")
- numero_comprobante: n\xFAmero completo del documento
- puesto: c\xF3digo punto de venta (ej: "00003")
- numero_secuencial: n\xFAmero secuencial sin punto de venta (ej: "00000001") 
- fecha_emision: formato YYYY-MM-DD
- razon_social_emisor: quien emite
- razon_social_receptor: quien recibe
- cuit_emisor: 11 d\xEDgitos
- cuit_receptor: 11 d\xEDgitos

EJEMPLO para Factura E:
{
  "tipo_comprobante": "factura",
  "subtipo_comprobante": "Factura E",
  "numero_comprobante": "00003-00000001",
  "puesto": "00003", 
  "numero_secuencial": "00000001",
  "fecha_emision": "2025-08-12",
  "razon_social_emisor": "LARROSA LAMBRECHT FRANCISCO NAHUEL",
  "razon_social_receptor": "MINDATA PROCUREMENT SERVICES S.L.",
  "cuit_emisor": "20395507304",
  "cuit_receptor": "55000004102",
  "confidence": 0.95
}`}]}],generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",required:["tipo_comprobante","confidence"],properties:{tipo_comprobante:{type:"STRING",enum:["factura","orden_de_pago","retenciones","informe","desconocido"]},subtipo_comprobante:{type:"STRING"},numero_comprobante:{type:"STRING"},puesto:{type:"STRING"},numero_secuencial:{type:"STRING"},fecha_emision:{type:"STRING",pattern:"^\\d{4}-\\d{2}-\\d{2}$"},cuit_emisor:{type:"STRING",pattern:"^\\d{11}$"},cuit_receptor:{type:"STRING",pattern:"^\\d{11}$"},razon_social_emisor:{type:"STRING"},razon_social_receptor:{type:"STRING"},empresa_codigo:{type:"STRING"},monto_total:{type:"NUMBER",minimum:0},moneda:{type:"STRING"},letra:{type:"STRING",enum:["A","B","C","E","M"]},confidence:{type:"NUMBER",minimum:0,maximum:1},observaciones:{type:"STRING"}}},maxOutputTokens:500}},s=await fetch(`${j.apiBase}/ai/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"gemini-2.5-flash-lite",payload:o})});if(!s.ok){let L=await s.text().catch(()=>"");throw new Error(L||`HTTP ${s.status}`)}let b=(await s.json())?.candidates?.[0]?.content?.parts?.[0]?.text||"{}",d=JSON.parse(b);this.processingState.set("validando");let x=await this.validarFacturaAFIP(d,t),A={type:d.tipo_comprobante||"desconocido",subtipo:d.subtipo_comprobante||"",dateISO:d.fecha_emision||this.todayISO(),puesto:d.puesto||"",numeroSecuencial:this.extractNumeroSecuencial(d),empresaCodigo:d.razon_social_receptor?this.getEmpresaCodigo(d.razon_social_receptor):"XXX",ejercicio:this.selectedEjercicio()},m=this.generateFileName(A),N=this.generateFullPath(A,m);return this.agregarArchivoProcessado(e,m,N,d,x),this.processingState.set("obteniendo"),d}generateFileName(e){let t=this.validISO(e.dateISO)?e.dateISO:this.todayISO(),[n,o]=t.split("-"),s=this.getComprobanteCodigo(e.subtipo||e.type),u=this.getUltimos4Digitos(e.numeroSecuencial),b=e.empresaCodigo||"XXX";return`${n}-${o}-${s}-${u}-${b}.pdf`}generateFullPath(e,t){let n=this.validISO(e.dateISO)?e.dateISO:this.todayISO(),[o,s]=n.split("-");return`/${e.ejercicio}/Ventas/${o}-${s}/${t}`}validISO(e){return!!(e&&/^\d{4}-\d{2}-\d{2}$/.test(e))}todayISO(){let e=new Date,t=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${e.getFullYear()}-${t}-${n}`}getComprobanteCodigo(e){if(!e)return console.log("\u26A0\uFE0F Subtipo vac\xEDo, usando fallback"),this.getFallbackCode();console.log(`\u{1F50D} Buscando c\xF3digo para: "${e}"`);for(let[t,n]of Object.entries(Me)){let o=t.toLowerCase(),s=e.toLowerCase();if(s===o)return console.log(`\u2705 Match exacto: "${e}" \u2192 ${n}`),n;if(this.matchesTipoComprobante(s,o))return console.log(`\u2705 Match espec\xEDfico: "${e}" \u2192 ${n}`),n}for(let[t,n]of Object.entries(Me)){let o=t.toLowerCase();if(e.toLowerCase().includes(o))return console.log(`\u2705 Match parcial: "${e}" \u2192 ${n}`),n}return console.log(`\u26A0\uFE0F Usando fallback para: "${e}" (tipo: ${this.form.type})`),this.getFallbackCode()}getFallbackCode(){switch(this.form.type){case"factura":return"FacA";case"informe":return"Inf";case"orden_de_pago":return"OrdP";case"retenciones":return"Ret";default:return"XXX"}}matchesTipoComprobante(e,t){return!!(t.includes("factura a")&&e.match(/\bfactura\s+a\b/i)||t.includes("factura b")&&e.match(/\bfactura\s+b\b/i)||t.includes("factura c")&&e.match(/\bfactura\s+c\b/i)||t.includes("factura e")&&(e.match(/\bfactura\s+e\b/i)||e.includes("exporta"))||t.includes("exportaci\xF3n")&&e.includes("exporta")||t.includes("fce a")&&e.includes("fce")&&e.match(/\ba\b/i)||t.includes("fce b")&&e.includes("fce")&&e.match(/\bb\b/i))}extractNumeroSecuencial(e){let t=e.numero_secuencial||"";if(console.log(`\u{1F522} Extrayendo n\xFAmero secuencial inicial: "${t}"`),(!t||t.length<3||/^0+$/.test(t.replace(/\D/g,"")))&&e.numero_comprobante){let o=e.numero_comprobante.match(/(\d+)-(\d+)/);if(o&&o[2])t=o[2],console.log(`\u{1F527} Fallback n\xFAmero secuencial: "${e.numero_secuencial}" + "${e.numero_comprobante}" \u2192 "${t}"`);else{let s=e.numero_comprobante.replace(/\D/g,"");s.length>=4?(t=s.slice(-8),console.log(`\u{1F527} Fallback secundario: "${e.numero_comprobante}" \u2192 "${t}"`)):(console.log("\u26A0\uFE0F No se pudo extraer n\xFAmero secuencial, usando vac\xEDo"),t="")}}else t&&console.log(`\u2705 N\xFAmero secuencial detectado correctamente: "${t}"`);return t}getUltimos4Digitos(e){if(console.log(`\u{1F522} Procesando n\xFAmero secuencial: "${e}"`),!e)return console.log("\u26A0\uFE0F N\xFAmero secuencial vac\xEDo, usando 0000"),"0000";let t=e.replace(/\D+/g,"");if(console.log(`\u{1F522} D\xEDgitos extra\xEDdos: "${t}"`),!t)return console.log(`\u26A0\uFE0F No se encontraron d\xEDgitos en "${e}", usando 0000`),"0000";let o=t.slice(-4).padStart(4,"0");return console.log(`\u2705 \xDAltimos 4 d\xEDgitos: "${e}" \u2192 "${o}" (de "${t}")`),o}getEmpresaCodigo(e){if(!e)return"XXX";console.log(`\u{1F3E2} Mapeando empresa: "${e}"`);let t=e.toUpperCase().trim();for(let[s,u]of Object.entries(se))if(t===s.toUpperCase())return console.log(`\u2705 Mapeo exacto: "${e}" \u2192 ${u}`),u;for(let[s,u]of Object.entries(se))if(t.includes(s.toUpperCase()))return console.log(`\u2705 Mapeo por inclusi\xF3n: "${e}" contiene "${s}" \u2192 ${u}`),u;for(let[s,u]of Object.entries(se))if(s.toUpperCase().includes(t))return console.log(`\u2705 Mapeo inverso: "${s}" contiene "${e}" \u2192 ${u}`),u;console.log(`\u26A0\uFE0F No se encontr\xF3 mapeo fijo para: "${e}", generando din\xE1micamente...`);let n=e.toUpperCase().replace(/[^A-ZÃ‘\s]/g,"").split(/\s+/).filter(s=>s.length>1&&!["SA","SAS","SRL","LTDA","CIA","Y","E","DE","DEL","LA","LAS","EL","LOS"].includes(s)),o="";return n.length>=2?o=n[0].substring(0,2)+n[1].substring(0,2):n.length===1?o=n[0].substring(0,4):o="XXXX",o.length>5?o=o.substring(0,5):o.length<3&&(o=o.padEnd(3,"X")),console.log(`\u26A0\uFE0F Generaci\xF3n din\xE1mica: "${e}" \u2192 ${o}`),o}async fileToBase64(e){return(await new Promise((n,o)=>{let s=new FileReader;s.onload=()=>n(String(s.result)),s.onerror=o,s.readAsDataURL(e)})).split(",")[1]||""}async classifyWithAIV2(){let e=this.file();if(!e){this.error.set("Seleccion\xE1 un PDF primero");return}this.isProcessing.set(!0),this.processingState.set("obteniendo"),this.error.set(null),this.procesandoMultiples()||this.archivosProcesados.set([]);try{let t=await this.fileToBase64(e),o={contents:[{parts:[{inline_data:{mime_type:e.type||"application/pdf",data:t}},{text:`Analiza esta factura PDF para el sistema InvoiceIA.

IMPORTANTE: Debes ser MUY ESPEC\xCDFICO con el tipo exacto de factura.

EXTRAE INFORMACI\xD3N ESPEC\xCDFICA PARA FORMATO: AAAA-MM-CCCC-NNNN-EEEE.pdf

DETECCI\xD3N DE TIPO DE FACTURA - BUSCA EXACTAMENTE:
- Si ves "FACTURA A" o "COD A" \u2192 subtipo_comprobante: "Factura A"
- Si ves "FACTURA B" o "COD B" \u2192 subtipo_comprobante: "Factura B"  
- Si ves "FACTURA C" o "COD C" \u2192 subtipo_comprobante: "Factura C"
- Si ves "FACTURA E" o "COD E" o "EXPORTACI\xD3N" \u2192 subtipo_comprobante: "Factura E"
- Si es FCE \u2192 subtipo_comprobante: "Factura de Cr\xE9dito Electr\xF3nica MiPyMEs (FCE) A"
- Si es Nota de Cr\xE9dito \u2192 subtipo_comprobante: "Nota de Cr\xE9dito A/B" (seg\xFAn corresponda)
- Si es Nota de D\xE9bito \u2192 subtipo_comprobante: "Nota de D\xE9bito A/B" (seg\xFAn corresponda)

EXTRACCI\xD3N DE N\xDAMEROS - MUY IMPORTANTE:
- Busca "Comp. Nro:" o "N\xFAmero:" seguido del formato "XXXX-XXXXXXXX"
- Ejemplo: "Comp. Nro: 00003-00000001"
  - puesto: "00003" (parte antes del gui\xF3n)
  - numero_secuencial: "00000001" (parte despu\xE9s del gui\xF3n)

CAMPOS REQUERIDOS:
- tipo_comprobante: (factura|informe|orden_de_pago|retenciones|desconocido)
- subtipo_comprobante: EL TIPO EXACTO con letra (ej: "Factura A", "Factura E")
- numero_comprobante: n\xFAmero completo del documento
- puesto: c\xF3digo punto de venta (ej: "00003")
- numero_secuencial: n\xFAmero secuencial sin punto de venta (ej: "00000001") 
- fecha_emision: formato YYYY-MM-DD
- razon_social_emisor: quien emite
- razon_social_receptor: quien recibe
- cuit_emisor: 11 d\xEDgitos
- cuit_receptor: 11 d\xEDgitos

EJEMPLO para Factura E:
{
  "tipo_comprobante": "factura",
  "subtipo_comprobante": "Factura E",
  "numero_comprobante": "00003-00000001",
  "puesto": "00003", 
  "numero_secuencial": "00000001",
  "fecha_emision": "2025-08-12",
  "razon_social_emisor": "LARROSA LAMBRECHT FRANCISCO NAHUEL",
  "razon_social_receptor": "MINDATA PROCUREMENT SERVICES S.L.",
  "cuit_emisor": "20395507304",
  "cuit_receptor": "55000004102",
  "confidence": 0.95
}`}]}],generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",required:["tipo_comprobante","confidence"],properties:{tipo_comprobante:{type:"STRING",enum:["factura"]},subtipo_comprobante:{type:"STRING"},numero_comprobante:{type:"STRING"},puesto:{type:"STRING"},numero_secuencial:{type:"STRING"},fecha_emision:{type:"STRING",pattern:"^\\d{4}-\\d{2}-\\d{2}$"},cuit_emisor:{type:"STRING",pattern:"^\\d{11}$"},cuit_receptor:{type:"STRING",pattern:"^\\d{11}$"},razon_social_emisor:{type:"STRING"},razon_social_receptor:{type:"STRING"},empresa_codigo:{type:"STRING"},monto_total:{type:"NUMBER",minimum:0},moneda:{type:"STRING"},letra:{type:"STRING",enum:["A","B","C","E","M"]},confidence:{type:"NUMBER",minimum:0,maximum:1},observaciones:{type:"STRING"}}},maxOutputTokens:500}},s=await fetch(`${j.apiBase}/ai/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"gemini-2.5-flash-lite",payload:o})});if(!s.ok){let Ie=await s.text().catch(()=>"");throw new Error(Ie||`HTTP ${s.status}`)}let b=(await s.json())?.candidates?.[0]?.content?.parts?.[0]?.text||"{}",d=JSON.parse(b);this.extractedData.set(d),this.processingState.set("validando");let x=await this.validarFacturaAFIP(d,t);this.form.type=d.tipo_comprobante||"desconocido",this.form.subtipo=d.subtipo_comprobante||"",this.form.ejercicio=this.selectedEjercicio(),d.fecha_emision&&/^\d{4}-\d{2}-\d{2}$/.test(d.fecha_emision)&&(this.form.dateISO=d.fecha_emision),d.puesto&&(this.form.puesto=d.puesto),d.numero_secuencial&&(this.form.numeroSecuencial=d.numero_secuencial),this.form.type=d.tipo_comprobante||"desconocido",this.form.subtipo=d.subtipo_comprobante||"",this.form.dateISO=d.fecha_emision||this.todayISO(),this.form.puesto=d.puesto||"";let A=this.extractNumeroSecuencial(d);this.form.numeroSecuencial=A,this.form.ejercicio=this.selectedEjercicio(),d.razon_social_receptor&&(this.form.empresaCodigo=this.getEmpresaCodigo(d.razon_social_receptor));let m={type:d.tipo_comprobante||"desconocido",subtipo:d.subtipo_comprobante||"",dateISO:d.fecha_emision||this.todayISO(),puesto:d.puesto||"",numeroSecuencial:A,empresaCodigo:d.razon_social_receptor?this.getEmpresaCodigo(d.razon_social_receptor):"XXX",ejercicio:this.selectedEjercicio()},N=this.generateFileName(m),L=this.generateFullPath(m,N);console.log("\u{1F4C1} Ruta completa V2:",L),console.log("\u{1F4C4} Nombre archivo V2:",N),this.agregarArchivoProcessado(e,N,L,d,x),this.evaluarImporte(d)}catch(t){this.error.set(t?.message||"No se pudo clasificar con IA V2.")}finally{this.isProcessing.set(!1),this.processingState.set("idle")}}async validarFacturaAFIP(e,t){try{console.log("\u{1F50D} Iniciando validaci\xF3n AFIP de la factura...");let n=`Act\xFAa como un verificador experto de facturas de AFIP (Administraci\xF3n Federal de Ingresos P\xFAblicos de Argentina).

DATOS EXTRA\xCDDOS DE LA FACTURA:
- Tipo: ${e.tipo_comprobante}
- Subtipo: ${e.subtipo_comprobante||"No especificado"}
- N\xFAmero: ${e.numero_comprobante}
- Fecha: ${e.fecha_emision}
- Emisor: ${e.razon_social_emisor||"No especificado"}
- CUIT Emisor: ${e.cuit_emisor}
- Receptor: ${e.razon_social_receptor||"No especificado"}
- CUIT Receptor: ${e.cuit_receptor}
- Monto: $${e.monto_total||"No especificado"}
- Moneda: ${e.moneda||"ARS"}

TAREAS DE VALIDACI\xD3N:

1. VALIDACI\xD3N DE NORMAS AFIP:
   \u2713 Verificar formato de CUIT (debe ser 11 d\xEDgitos)
   \u2713 Validar estructura del n\xFAmero de comprobante (formato XXXX-XXXXXXXX)
   \u2713 Verificar tipo de factura seg\xFAn relaci\xF3n emisor/receptor
   \u2713 Validar fecha de emisi\xF3n (no debe ser futura ni muy antigua)
   \u2713 Verificar coherencia entre letra de factura y condici\xF3n fiscal
   \u2713 Verificar presencia de CAE (C\xF3digo de Autorizaci\xF3n Electr\xF3nico)

2. DETECCI\xD3N DE SIGNOS DE MANIPULACI\xD3N VISUAL:
   \u26A0\uFE0F Buscar inconsistencias en tipograf\xEDas
   \u26A0\uFE0F Detectar alineaciones anormales de texto
   \u26A0\uFE0F Identificar posible superposici\xF3n de textos
   \u26A0\uFE0F Analizar calidad de imagen (borrosidad sospechosa)
   \u26A0\uFE0F Verificar si n\xFAmeros o montos parecen alterados digitalmente
   \u26A0\uFE0F Comprobar presencia y coherencia de c\xF3digos de barras/QR

3. VALIDACIONES DE COHERENCIA:
   \u{1F4CA} Verificar relaci\xF3n entre monto en n\xFAmeros y letras
   \u{1F4CA} Validar c\xE1lculos de subtotales e IVA
   \u{1F4CA} Comprobar que los datos del emisor est\xE9n completos
   \u{1F4CA} Verificar coherencia de montos con tipo de factura

RESPONDE EN ESTE FORMATO:

\u2705 VALIDACIONES EXITOSAS:
- (lista de validaciones que pasaron correctamente)

\u26A0\uFE0F ADVERTENCIAS:
- (lista de cosas que requieren atenci\xF3n pero no son cr\xEDticas)

\u274C ERRORES CR\xCDTICOS:
- (lista de errores que invalidan la factura)

\u{1F50D} SIGNOS DE MANIPULACI\xD3N DETECTADOS:
- (lista si hay signos de alteraci\xF3n, o "Ninguno detectado")

\u{1F4CA} NIVEL DE CONFIANZA: (Alto/Medio/Bajo)

\u{1F4A1} RECOMENDACIONES:
- (lista de acciones sugeridas)`,o={contents:[{parts:[{inline_data:{mime_type:"application/pdf",data:t}},{text:n}]}],generationConfig:{maxOutputTokens:1e3,temperature:.2}},s=await fetch(`${j.apiBase}/ai/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"gemini-2.5-flash-lite",payload:o})});if(!s.ok)return console.error("\u26A0\uFE0F Error en validaci\xF3n AFIP"),"\u26A0\uFE0F Error al validar la factura con AFIP";let b=(await s.json())?.candidates?.[0]?.content?.parts?.[0]?.text||"No se pudo obtener resultado de validaci\xF3n";return console.log(`
`+"=".repeat(80)),console.log("\u{1F50D} RESULTADO DE VALIDACI\xD3N AFIP"),console.log("=".repeat(80)),console.log(b),console.log("=".repeat(80)+`
`),b}catch(n){return console.error("\u274C Error en validaci\xF3n AFIP:",n),"\u274C Error al procesar la validaci\xF3n AFIP: "+n.message}}evaluarImporte(e){if(!e.monto_total){console.log("\u26A0\uFE0F No se encontr\xF3 monto total en la factura"),this.mostrarPagar.set(!1);return}return e.monto_total<5e4?(console.log("\u2705 PAGAR - Monto: $"+e.monto_total.toLocaleString("es-AR")),this.mostrarPagar.set(!0),"PAGAR"):(this.enviarEmailFactura(e),console.log("\u{1F4E7} Email enviado - Monto: $"+e.monto_total.toLocaleString("es-AR")),this.mostrarPagar.set(!1),"EMAIL_ENVIADO")}async enviarEmailFactura(e){try{let t={to_email:"admin@invoiceai.com",from_name:"InvoiceAI System",subject:`Factura para revision - ${e.subtipo_comprobante||"Factura"} - $${e.monto_total?.toLocaleString("es-AR")}`,message:["Se requiere revision de la siguiente factura:","",`Tipo: ${e.subtipo_comprobante}`,`Numero: ${e.numero_comprobante}`,`Fecha: ${e.fecha_emision}`,`Monto: $${e.monto_total?.toLocaleString("es-AR")}`,"",`Emisor: ${e.razon_social_emisor}`,`CUIT Emisor: ${e.cuit_emisor}`,"",`Receptor: ${e.razon_social_receptor}`,`CUIT Receptor: ${e.cuit_receptor}`,"","Por favor revisar y aprobar."].join(`
`)};await ae.send("service_email_invoiceia","template_6my5ups",t,"ktFlh61zh67x7iPrd"),console.log("\u2705 Email enviado correctamente")}catch(t){console.error("\u274C Error al enviar email:",t),this.error.set("Error al enviar email: "+t.message)}}triggerDownloadV2(e,t){let n=URL.createObjectURL(e),o=document.createElement("a");o.href=n,o.download=t,document.body.appendChild(o),o.click(),o.remove(),URL.revokeObjectURL(n)}onEjercicioChange(){this.form.ejercicio=this.selectedEjercicio()}agregarArchivoProcessado(e,t,n,o,s){let u=this.archivosProcesados();u.push({file:e,fileName:t,fullPath:n,data:o,ejercicio:this.selectedEjercicio(),validacionAFIP:s}),this.archivosProcesados.set([...u])}async descargarZipOrganizado(){let e=this.archivosProcesados();if(e.length===0){this.error.set("No hay archivos procesados para organizar");return}try{let t=(await import("./chunk-MLFYVYV3.js")).default,n=new t;for(let b of e){let d=b.fullPath.split("/").filter(m=>m),x=n;for(let m=0;m<d.length-1;m++){let N=d[m];x=x.folder(N)||x}let A=await b.file.arrayBuffer();x.file(b.fileName,A)}let o=await n.generateAsync({type:"blob"}),s=URL.createObjectURL(o),u=document.createElement("a");u.href=s,u.download=`DocAI-V2-${this.selectedEjercicio()}-${new Date().toISOString().split("T")[0]}.zip`,document.body.appendChild(u),u.click(),u.remove(),URL.revokeObjectURL(s),this.archivosProcesados.set([])}catch(t){this.error.set("Error al crear ZIP organizado: "+t.message)}}limpiarArchivosProcessados(){this.archivosProcesados.set([]),this.file.set(null),this.extractedData.set(null),this.colaArchivos.set([])}eliminarArchivoProcesado(e){let t=this.archivosProcesados();t.splice(e,1),this.archivosProcesados.set([...t]),t.length===0&&(this.file.set(null),this.extractedData.set(null),this.colaArchivos.set([]))}descargarArchivoIndividual(e){let t=this.archivosProcesados();if(e>=0&&e<t.length){let n=t[e];this.triggerDownloadV2(n.file,n.fileName)}}toggleSidebar(){this.utilService.toggleSidebarState()}enviarMailFactura(e){let t={invoice_number:e.invoice_number,customer_name:e.customer_name,amount:e.amount,items:JSON.stringify(e.items,null,2)};ae.send("service_email_invoiceia","template_6my5ups",t,"ktFlh61zh67x7iPrd").then(n=>{console.log("Email enviado correctamente",n.status,n.text)},n=>{console.error("Error enviando email",n)})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=ce({type:i,selectors:[["app-oda-invoice"]],decls:21,vars:14,consts:[["data-aos","fade-right",1,"p-6","min-h-screen","bg-gradient-to-br","from-background","via-background","to-background/90","docaiV2Container","relative"],[1,"max-w-2xl","mx-auto","mb-6","space-y-4"],[1,"max-w-2xl","mx-auto","mb-8"],[1,"space-y-4"],[1,"relative","mt-16","border-2","border-dashed","rounded-xl","p-6","text-center","transition-all","duration-300","dropzone",3,"dragover","dragleave","drop","ngClass"],[1,"icon-container","mb-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","mx-auto","text-slate-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"],[1,"text-container"],[1,"text-base","font-medium","text-white","mb-1"],["type","file","accept",".pdf","multiple","",1,"absolute","inset-0","w-full","h-full","opacity-0","cursor-pointer",3,"change"],[1,"p-4","bg-blue-900/20","border","border-blue-500/30","rounded-lg"],[1,"p-4","bg-purple-900/20","border","border-purple-500/30","rounded-lg"],[1,"p-4","bg-red-900/20","border","border-red-500/20","rounded-lg"],[1,"w-full","py-2.5","px-4","bg-gradient-to-r","from-main","to-secondary","hover:from-hover","hover:to-main","disabled:opacity-50","text-white","font-medium","rounded-lg","transition-all","duration-300","flex","items-center","justify-center","gap-2","shadow-lg","hover:shadow-main/25","hover:scale-105",3,"disabled"],[1,"w-full","py-2.5","px-4","bg-gradient-to-r","from-green-500","to-green-700","hover:from-green-600","hover:to-green-800","disabled:opacity-50","text-white","font-medium","rounded-lg","transition-all","duration-300","flex","items-center","justify-center","gap-2","shadow-lg","hover:shadow-green-500/30","hover:scale-105",3,"disabled"],["data-aos","fade-up",1,"max-w-2xl","mx-auto","mt-6","bg-slate-800/60","rounded-lg","border","border-slate-700/50","overflow-hidden"],[1,"max-w-2xl","mx-auto","mt-6","p-4","bg-slate-800/60","rounded-lg","border","border-slate-700/50"],[1,"fixed","inset-0","bg-black/60","backdrop-blur-sm","flex","items-center","justify-center","z-50","p-4"],[1,"text-base","font-medium","text-blue-300","mb-1"],[1,"text-xs","text-blue-400"],[1,"text-base","font-medium","text-violet-300","mb-1"],[1,"text-xs","text-violet-400"],[1,"flex","items-center","justify-between","mb-3"],[1,"font-medium","text-blue-300"],[1,"px-2","py-1","bg-blue-500/20","text-blue-300","rounded","text-sm"],[1,"flex","items-center","gap-2","text-sm"],["fill","none","viewBox","0 0 24 24",1,"w-4","h-4","text-blue-400","animate-spin","flex-shrink-0"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-blue-400","flex-shrink-0"],[1,"truncate"],[1,"text-xs","text-blue-400","ml-auto"],[1,"mt-3","text-xs","text-blue-400"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"],[1,"font-medium","text-purple-300"],[1,"px-2","py-1","bg-purple-500/20","text-purple-300","rounded","text-sm"],[1,"space-y-2","max-h-32","overflow-y-auto","custom-scrollbar"],[1,"flex","items-center","gap-2","text-sm",3,"text-purple-300","text-slate-400"],[1,"mt-3","text-xs","text-purple-400"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-green-500","flex-shrink-0"],["fill","none","viewBox","0 0 24 24",1,"w-4","h-4","text-purple-400","animate-spin","flex-shrink-0"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-slate-500","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-red-400","font-medium"],[1,"w-full","py-2.5","px-4","bg-gradient-to-r","from-main","to-secondary","hover:from-hover","hover:to-main","disabled:opacity-50","text-white","font-medium","rounded-lg","transition-all","duration-300","flex","items-center","justify-center","gap-2","shadow-lg","hover:shadow-main/25","hover:scale-105",3,"click","disabled"],[1,"flex","items-center","gap-4"],["fill","none","viewBox","0 0 24 24",1,"w-5","h-5","animate-spin"],[1,"w-full","py-2.5","px-4","bg-gradient-to-r","from-green-500","to-green-700","hover:from-green-600","hover:to-green-800","disabled:opacity-50","text-white","font-medium","rounded-lg","transition-all","duration-300","flex","items-center","justify-center","gap-2","shadow-lg","hover:shadow-green-500/30","hover:scale-105",3,"click","disabled"],[1,"p-4","cursor-pointer","hover:bg-slate-700/30","transition-colors",3,"click"],[1,"flex","items-center","justify-between"],[1,"text-base","font-semibold","text-white","flex","items-center","gap-3"],[1,"fas","fa-eye","text-main"],[1,"flex","items-center","gap-2"],[1,"text-xs","text-slate-400","bg-slate-700","px-2","py-1","rounded"],[1,"fas","fa-chevron-down","text-slate-400","transform","transition-transform","duration-300"],[1,"metadata-content","overflow-hidden","transition-all","duration-500","ease-in-out"],[1,"p-4","pt-0","border-t","border-slate-600/50"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-4"],[1,"space-y-2"],[1,"flex","justify-between"],[1,"text-xs","text-slate-400"],[1,"text-xs","text-white","font-medium"],[1,"flex","justify-between","items-center"],[1,"text-xs","px-2","py-0.5","bg-green-500","text-white","rounded-full"],[1,"text-xs","px-2","py-0.5","bg-blue-500","text-white","rounded-full"],[1,"bg-slate-700/40","rounded","p-3"],[1,"text-xs","font-medium","text-slate-300","mb-2","flex","items-center","gap-2"],[1,"fas","fa-code","text-xs"],[1,"text-xs","text-slate-400","overflow-auto","max-h-32","custom-scrollbar"],[1,"text-base","font-semibold","text-white","flex","items-center","gap-2"],[1,"fas","fa-file-pdf","text-red-400"],[1,"px-2","py-1","bg-blue-500/20","text-blue-400","rounded-full","text-xs"],[1,"space-y-3","mb-3","max-h-96","overflow-y-auto","custom-scrollbar"],["data-aos","fade-up",1,"bg-slate-700/60","rounded-lg","border","border-slate-600/50","overflow-hidden"],[1,"flex","justify-end"],[1,"py-2","px-3","bg-slate-600/60","hover:bg-slate-500/60","text-white","text-sm","font-medium","rounded","transition-colors",3,"click"],[1,"p-3","cursor-pointer","hover:bg-slate-600/30","transition-colores",3,"click"],[1,"flex","items-center","gap-3","flex-1","min-w-0"],[1,"fas","fa-eye","text-main","text-sm"],[1,"flex-1","min-w-0"],[1,"text-sm","font-medium","text-white","truncate"],[1,"text-xs","text-slate-400","truncate"],[1,"text-xs","px-2","py-0.5","bg-green-600","text-white","rounded-full","font-semibold"],[1,"text-xs","px-2","py-0.5","bg-red-600","text-white","rounded-full","font-semibold"],["title","Chat con IA",1,"p-1","text-blue-400","hover:text-blue-300","hover:bg-blue-500/10","rounded",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"],["title","Eliminar",1,"p-1","text-red-400","hover:text-red-300","hover:bg-red-500/10","rounded",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"p-3","pt-0","border-t","border-slate-600/50"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-3","mb-3"],[1,"text-xs","text-white","font-medium","truncate"],[1,"bg-slate-800/40","rounded","p-3","overflow-y-scroll","custom-scrollbar",2,"max-height","700px"],[1,"mb-4"],[1,"text-xs","text-slate-400","whitespace-pre-wrap"],[1,"pt-4","border-t","border-slate-700/50",2,"height","300px"],[1,"text-sm","font-semibold","text-blue-300","mb-3","flex","items-center","gap-2"],[1,"fas","fa-shield-alt"],[1,"text-xs","text-slate-300","whitespace-pre-wrap","leading-relaxed","pb-4",2,"height","1000px"],[1,"fixed","inset-0","bg-black/60","backdrop-blur-sm","flex","items-center","justify-center","z-50","p-4",3,"click"],[1,"bg-slate-800","rounded-xl","shadow-2xl","w-full","max-w-3xl","max-h-[85vh]","flex","flex-col","border","border-slate-700",3,"click"],[1,"p-4","border-b","border-slate-700","flex","items-center","justify-between","bg-gradient-to-r","from-blue-600","to-blue-700"],[1,"flex","items-center","gap-3"],[1,"w-10","h-10","bg-white/10","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-white"],[1,"text-lg","font-semibold","text-white"],[1,"text-xs","text-blue-100"],[1,"p-2","hover:bg-white/10","rounded-lg","transition-colors","text-white",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],[1,"flex-1","overflow-y-auto","p-4","space-y-4","custom-scrollbar","bg-slate-900/50"],[1,"text-center","py-12"],[1,"flex","gap-3",3,"flex-row-reverse"],[1,"flex","gap-3"],[1,"p-4","border-t","border-slate-700","bg-slate-800/80"],[1,"flex","gap-2"],["type","text","placeholder","Escribe tu pregunta sobre la factura...",1,"flex-1","bg-slate-900/50","border","border-slate-700","rounded-lg","px-4","py-2.5","text-white","placeholder-slate-500","focus:outline-none","focus:border-blue-500","focus:ring-1","focus:ring-blue-500","disabled:opacity-50","disabled:cursor-not-allowed","text-sm",3,"input","keydown.enter","value","disabled"],[1,"px-4","py-2.5","bg-blue-600","hover:bg-blue-700","disabled:bg-slate-700","disabled:cursor-not-allowed","text-white","rounded-lg","transition-colors","flex","items-center","gap-2","font-medium","text-sm",3,"click","disabled"],["fill","none","viewBox","0 0 24 24",1,"w-4","h-4","animate-spin"],[1,"text-xs","text-slate-500","mt-2"],[1,"w-16","h-16","bg-blue-500/10","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-blue-400"],[1,"text-white","font-medium","mb-2"],[1,"text-slate-400","text-sm"],[1,"mt-6","grid","grid-cols-1","gap-2","max-w-md","mx-auto","text-left"],[1,"p-3","bg-slate-800/60","rounded-lg","border","border-slate-700/50"],[1,"text-xs","text-slate-300"],[1,"flex-shrink-0"],[1,"w-8","h-8","bg-blue-600","rounded-full","flex","items-center","justify-center"],[1,"w-8","h-8","bg-gradient-to-br","from-purple-500","to-pink-500","rounded-full","flex","items-center","justify-center"],[1,"flex-1","max-w-[80%]"],[1,"rounded-lg","p-3"],[1,"text-sm","whitespace-pre-wrap"],[1,"text-xs","text-slate-500","mt-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-white","animate-pulse"],[1,"bg-slate-800/60","border","border-slate-700/50","rounded-lg","p-3"],[1,"flex","gap-1"],[1,"w-2","h-2","bg-slate-400","rounded-full","animate-bounce",2,"animation-delay","0ms"],[1,"w-2","h-2","bg-slate-400","rounded-full","animate-bounce",2,"animation-delay","150ms"],[1,"w-2","h-2","bg-slate-400","rounded-full","animate-bounce",2,"animation-delay","300ms"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 19l9 2-9-18-9 18 9-2zm0 0v-8"]],template:function(t,n){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),D("dragover",function(s){return n.onDragOver(s)})("dragleave",function(s){return n.onDragLeave(s)})("drop",function(s){return n.onDrop(s)}),r(5,"div",5),C(),r(6,"svg",6),f(7,"path",7),a()(),F(),r(8,"div",8),_(9,Le,4,0)(10,$e,4,1)(11,Be,2,0,"p",9),a(),r(12,"input",10),D("change",function(s){return n.onPick(s)}),a()(),_(13,ze,17,11,"div",11),_(14,Ke,11,1,"div",12),_(15,Ze,3,1,"div",13),_(16,tt,3,2,"button",14)(17,st,3,2,"button",15),a()(),_(18,dt,63,18,"div",16),_(19,_t,13,1,"div",17),_(20,Vt,28,7,"div",18),a()()),t&2&&(c(4),O("ngClass",ue(9,je,n.isDragOver(),!n.isDragOver(),n.isDragOver()&&n.getDragFileCount()===1,n.isDragOver()&&n.getDragFileCount()>1)),c(5),v(n.isDragOver()&&n.getDragFileCount()===1?9:n.isDragOver()&&n.getDragFileCount()>1?10:11),c(4),v(n.file()&&n.colaArchivos().length<=1&&n.archivosProcesados().length===0?13:-1),c(),v(n.colaArchivos().length>1?14:-1),c(),v(n.error()?15:-1),c(),v(n.colaArchivos().length>1?16:17),c(2),v(n.extractedData()&&n.archivosProcesados().length===0?18:-1),c(),v(n.archivosProcesados().length>0?19:-1),c(),v(n.chatAbierto()?20:-1))},dependencies:[ge,me,be,he,fe,pe],styles:['@charset "UTF-8";.custom-scrollbar[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:rgba(255,31,67,.4) rgba(11,0,12,.5)}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#0b000cb3;border-radius:3px}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:linear-gradient(180deg,#ff1f4399,#e5091499,#8f001c99);border-radius:3px;border:1px solid rgba(143,0,28,.3);transition:all .3s ease}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:linear-gradient(180deg,#ff1f43e6,#e50914e6,#8f001ce6);transform:scaleX(1.1);box-shadow:0 0 8px #ff1f4366}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:active{background:linear-gradient(180deg,#ff1f43,#e50914,#8f001c);box-shadow:0 0 12px #ff1f4399}.custom-scrollbar-neutral[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:rgba(255,31,67,.3) rgba(11,0,12,.3)}.custom-scrollbar-neutral[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.custom-scrollbar-neutral[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#0b000c80;border-radius:3px}.custom-scrollbar-neutral[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ff1f4366;border-radius:3px;transition:all .2s ease}.custom-scrollbar-neutral[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#ff1f4399}.dropzone[_ngcontent-%COMP%]{transition:all .4s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;border-color:#ff1f434d;background-color:#0b000c33}.dropzone[_ngcontent-%COMP%]:hover{border-color:#ff1f4366;background-color:#ff1f430d;transform:translateY(-2px);box-shadow:0 4px 12px #ff1f4326}.drag-over[_ngcontent-%COMP%]{border-color:#ff1f43cc!important;background-color:#ff1f431a!important;border-width:2px!important;transform:scale(1.02) translateY(-4px)!important;animation:_ngcontent-%COMP%_pulse-border 1.5s infinite,_ngcontent-%COMP%_glow 2s ease-in-out infinite alternate;box-shadow:0 10px 25px #ff1f434d,0 0 0 3px #ff1f4333!important}.drag-idle[_ngcontent-%COMP%]{border-color:#ff1f434d;background-color:#0b000c33}.single-file[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]{color:#ff1f43cc!important;transform:scale(1.1);animation:_ngcontent-%COMP%_bounce-icon .6s ease-in-out infinite alternate}.multiple-files[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]{color:#ff1f43e6!important;transform:scale(1.15);animation:_ngcontent-%COMP%_pulse 1s infinite}.icon-container[_ngcontent-%COMP%]{transition:all .3s ease;color:#fff6}@keyframes _ngcontent-%COMP%_pulse-border{0%,to{border-color:#ff1f43cc}50%{border-color:#ff1f43}}@keyframes _ngcontent-%COMP%_glow{0%{box-shadow:0 10px 25px #ff1f434d,0 0 0 3px #ff1f4333}to{box-shadow:0 15px 35px #ff1f4366,0 0 0 4px #ff1f434d}}@keyframes _ngcontent-%COMP%_bounce-icon{0%{transform:scale(1.1) translateY(0)}to{transform:scale(1.1) translateY(-5px)}}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1.15);opacity:1}50%{transform:scale(1.2);opacity:.8}}.metadata-content.expanded[_ngcontent-%COMP%]{max-height:500px;opacity:1;animation:_ngcontent-%COMP%_expand-metadata .5s cubic-bezier(.4,0,.2,1) forwards}.metadata-content.collapsed[_ngcontent-%COMP%]{max-height:0;opacity:0;animation:_ngcontent-%COMP%_collapse-metadata .5s cubic-bezier(.4,0,.2,1) forwards}@keyframes _ngcontent-%COMP%_expand-metadata{0%{max-height:0;opacity:0;transform:translateY(-10px)}50%{opacity:.5}to{max-height:500px;opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_collapse-metadata{0%{max-height:500px;opacity:1;transform:translateY(0)}50%{opacity:.5}to{max-height:0;opacity:0;transform:translateY(-10px)}}.metadata-content[_ngcontent-%COMP%]   .bg-slate-700\\/40[_ngcontent-%COMP%]{transition:all .3s ease}.metadata-content[_ngcontent-%COMP%]   .bg-slate-700\\/40[_ngcontent-%COMP%]:hover{background-color:#33415599!important;transform:translateY(-1px);box-shadow:0 4px 12px #0003}.fas.fa-eye[_ngcontent-%COMP%]{transition:all .3s ease;animation:_ngcontent-%COMP%_eye-blink 3s infinite}@keyframes _ngcontent-%COMP%_eye-blink{0%,90%,to{transform:scaleY(1)}95%{transform:scaleY(.1)}}.bg-slate-900\\/60[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{line-height:1.6;font-family:Courier New,monospace}.bg-slate-900\\/60[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:inline-block}.fa-shield-alt[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_shield-pulse 2s ease-in-out infinite}@keyframes _ngcontent-%COMP%_shield-pulse{0%,to{transform:scale(1);opacity:1}50%{transform:scale(1.1);opacity:.8}}']})};export{we as DocAIV2};
